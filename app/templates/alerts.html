{% extends "base.html" %}

{% block title %}連絡掲示板{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <div class="flex items-center gap-3 mb-6">
        <h2 class="text-2xl font-bold text-slate-700"><i class="fas fa-bell text-rose-500"></i> 連絡・通知掲示板</h2>
        <span class="bg-rose-100 text-rose-600 px-3 py-1 rounded-full text-xs font-bold">管理者用</span>
    </div>

    {% if reports %}
        <div class="grid gap-4">
            {% for report, student_name in reports %}
            <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-5 flex flex-col sm:flex-row justify-between items-start gap-4 animate-in">
                <div class="flex gap-4">
                    <div class="w-12 h-12 rounded-full flex items-center justify-center text-xl flex-shrink-0
                        {{ 'bg-rose-100 text-rose-600' if report.report_type == '欠席' else 'bg-amber-100 text-amber-600' }}">
                        <i class="fas {{ 'fa-user-times' if report.report_type == '欠席' else 'fa-running' }}"></i>
                    </div>
                    <div>
                        <div class="flex items-center gap-2 mb-1">
                            <span class="font-bold text-lg text-slate-800">{{ student_name }}</span>
                            <span class="text-xs font-bold px-2 py-0.5 rounded border 
                                {{ 'bg-rose-50 text-rose-600 border-rose-200' if report.report_type == '欠席' else 'bg-amber-50 text-amber-600 border-amber-200' }}">
                                {{ report.report_type }}
                            </span>
                        </div>
                        <p class="text-slate-600 font-bold mb-2">理由: {{ report.reason }}</p>
                        <div class="text-xs text-slate-400">
                            <i class="far fa-clock mr-1"></i>{{ report.report_date.strftime('%Y/%m/%d %H:%M') }} 受信
                        </div>
                    </div>
                </div>
                
                <form action="{{ url_for('web.resolve_alert', record_id=report.record_id) }}" method="POST">
                    <button type="submit" class="bg-slate-800 hover:bg-slate-700 text-white px-6 py-2 rounded-lg text-sm font-bold shadow-md transition flex items-center gap-2">
                        <i class="fas fa-check"></i> 確認済みにする
                    </button>
                </form>
            </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="text-center py-20 bg-white rounded-2xl border border-dashed border-slate-300">
            <div class="text-6xl text-slate-200 mb-4"><i class="far fa-check-circle"></i></div>
            <p class="text-slate-400 font-bold">現在、未確認の連絡はありません。</p>
        </div>
    {% endif %}
</div>
{% endblock %}
